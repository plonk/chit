# Chit － したらば掲示板をチャット風に使う対話的インターフェース

PeerCast Plays Urahaku の為に作ったRubyスクリプトです。

* 一行入力すると投稿します。

* スレッドタイトルをパターンで指定して投稿先を指定することができます。

* Readlineライブラリを使っているので bash と同じように快適な行編集をす
ることができます(入力した投稿文の履歴は `~/.config/chit/history` に保
存されます)。

* いわゆる「多重投稿」（投稿間隔が短すぎて投稿が失敗すること）になった
場合は、自動で時間を置いて再投稿します。

* 新着レスを自動で読み込みます。

## 使ってみる

	$ ruby chit.rb shitaraba:///game/48538/PeerCast*:postable,oldest

とすると `PeerCast Plays Urahaku その108> ` のようなプロンプトが出て、
レスが入力できるようになります。行頭で Ctrl+D を入力すると終了します。

__ffi__ / __colorize__ が存在しない旨のエラーメッセージが出て起動しなかった場合は (sudo)
`gem install ffi` / `colorize` でインストールしてください。
__ffi__ をインストールするさいにmake, ruby-devなどが必要になる可能性があります。
`apt install make ruby-dev` など

# インストール

PATH の通ったディレクトリに `chit.rb` へのシンボリック・リンクを作って
はいかがですか。例えば chit.rb が /home/user/chit/chit.rb にあるとする
と：

	$ sudo ln -s /home/user/chit/chit.rb /usr/local/bin/chit

## スレッド指定文字列の仕様

### スレッド指定文字列：
` [プロトコル]://[ホスト]/[掲示板]/[スレッドパターン]:[オプション] `

> 例えば shitaraba:///game/1234/ABC*:postable,oldest で game/1234 掲示板の スレッドタイトルが ABC で始まるスレッドの内、スレッドストップになっておらず一番古くから存在するものを選択する。

> [スレッドパターン]はワイルドカード ? * を含むことのできるスレッドタイトルか、あるいは、スレッド番号（スレッドが立てられた Unix Timeである整数）。

### スレッド番号指定
` [プロトコル]://[ホスト]/[掲示板]/[スレッド番号]:thread [,オプション] `

> 例えば shitaraba:///game/1234/0123456789:thread で game/1234 掲示板の 0123456789 のスレッドを選択する。

> [thread]オプションが必須です。

### [オプション]は、以下の単語をコンマ区切りで並べたもの。()はショートカット
* `oldest` (`O`)  
一番古くに立てられたスレッドを選択
* `postable` (`P`)  
スレッドストップになっていないスレッドを選択
* `thread` (`T`)  
スレッド番号モード
* `multilines` (`M`)  
改行を含むレスは改行して複数行で表示する　
* `showtime` (`S`)  
時刻を表示する  
* `multilines` (`M`)  
オプションと同時に利用すると所謂2chスタイル(この場合のみIDも表示)  
* `last10` (`L`)  
最新レスから10レスだけを表示して開始  
